#!/usr/local/bin/koios
#   koios-polos (axis of heaven) unit testing meta-language



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
PREP          include the prototype headers                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
   incl       include public header                themis.h                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (SET) verify updating ownership                                    0s   owner           SET__owner                                                                   ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       initialize program                                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     initialize the logger (quiet mode)   TEST__unit_quiet                                                                                                                  i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char    x_recd   [LEN_RECD]  = "";                                                                                                                                                                                         
     local    create working variable              - - - - - - - - - - - - -   char    x_name   [LEN_PATH]  = "/tmp/themis.conf";                                                                                                                                                                         
     exec     remove file                          yURG_rm                     x_name                                                                                                i_equal     0                                                                                                    

   COND       verify updating an owner                                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     create test file                     yURG_touch                  x_name                                             , "member"  , "users"      , "0600"                i_equal     0                                                                                                    
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "file  Д testing conf file              Д a Д и Д и Д /tmp/themis.conf               Д root   Д root   Д f_open     Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     locate the file                      CHECK__exist                BEG_CHECK   + 2, my.target                                                                            i_equal     0                                                                                                    
     exec     check against root                   CHECK__owner                BEG_CHECK   + 4, my.own                                                                               i_lesser    0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeи-ииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     update owner                         SET__owner                  BEG_UPDATE  + 2, BEG_CHECK   + 4                                                                      i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeи-ииииии и   иOииииииии и   ииииииииии и   иТ                                  

   COND       verify when owner is already correct                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "file  Д testing conf file              Д a Д и Д и Д /tmp/themis.conf               Д root   Д root   Д f_open     Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     locate the file                      CHECK__exist                BEG_CHECK   + 2, my.target                                                                            i_equal     0                                                                                                    
     exec     check against root                   CHECK__owner                BEG_CHECK   + 4, my.own                                                                               i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeиoииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     update owner                         SET__owner                  BEG_UPDATE  + 2, BEG_CHECK   + 4                                                                      i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeиoииииии и   иoииииииии и   ииииииииии и   иТ                                  

   COND       verify pushing forward when check was bad                          - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "file  Д testing conf file              Д a Д и Д и Д /tmp/themis.conf               Д HELLO  Д root   Д f_open     Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     locate the file                      CHECK__exist                BEG_CHECK   + 2, my.target                                                                            i_equal     0                                                                                                    
     exec     check against root                   CHECK__owner                BEG_CHECK   + 4, my.own                                                                               i_lesser    0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeи?ииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     update owner                         SET__owner                  BEG_UPDATE  + 2, BEG_CHECK   + 4                                                                      i_lesser    0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeи?ииииии и   и░ииииииии и   ииииииииии и   иТ                                  

   COND       verify pushing forward when check was not run                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "file  Д testing conf file              Д a Д и Д и Д /tmp/themis.conf               Д HELLO  Д root   Д f_open     Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     locate the file                      CHECK__exist                BEG_CHECK   + 2, my.target                                                                            i_equal     0                                                                                                    
     exec     update owner                         SET__owner                  BEG_UPDATE  + 2, BEG_CHECK   + 4                                                                      i_lesser    0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeииииииии и   и?ииииииии и   ииииииииии и   иТ                                  

   COND       wrap up program                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.007))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     remove file                          yURG_rm                     x_name                                                                                                i_equal     0                                                                                                    
     exec     initialize the logger (quiet mode)   TEST__unit_end                                                                                                                    i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (SET) verify updating group                                        0s   group           SET__group                                                                   ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       initialize program                                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     initialize the logger (quiet mode)   TEST__unit_quiet                                                                                                                  i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char    x_recd   [LEN_RECD]  = "";                                                                                                                                                                                         
     local    create working variable              - - - - - - - - - - - - -   char    x_name   [LEN_PATH]  = "/tmp/themis.conf";                                                                                                                                                                         
     exec     remove file                          yURG_rm                     x_name                                                                                                i_equal     0                                                                                                    

   COND       verify updating an owner                                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     create test file                     yURG_touch                  x_name                                             , "member"  , "users"      , "0600"                i_equal     0                                                                                                    
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "file  Д testing conf file              Д a Д и Д и Д /tmp/themis.conf               Д root   Д root   Д f_open     Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     locate the file                      CHECK__exist                BEG_CHECK   + 2, my.target                                                                            i_equal     0                                                                                                    
     exec     check against root                   CHECK__group                BEG_CHECK   + 5, my.grp                                                                               i_lesser    0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeии-иииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     update group                         SET__group                  BEG_UPDATE  + 3, BEG_CHECK   + 5                                                                      i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeии-иииии и   ииGиииииии и   ииииииииии и   иТ                                  

   COND       verify when owner is already correct                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "file  Д testing conf file              Д a Д и Д и Д /tmp/themis.conf               Д root   Д root   Д f_open     Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     locate the file                      CHECK__exist                BEG_CHECK   + 2, my.target                                                                            i_equal     0                                                                                                    
     exec     check against root                   CHECK__group                BEG_CHECK   + 5, my.grp                                                                               i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeииgиииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     update group                         SET__group                  BEG_UPDATE  + 3, BEG_CHECK   + 5                                                                      i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeииgиииии и   ииgиииииии и   ииииииииии и   иТ                                  

   COND       verify pushing forward when check was bad                          - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "file  Д testing conf file              Д a Д и Д и Д /tmp/themis.conf               Д root   Д ZAP    Д f_open     Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     locate the file                      CHECK__exist                BEG_CHECK   + 2, my.target                                                                            i_equal     0                                                                                                    
     exec     check against root                   CHECK__group                BEG_CHECK   + 5, my.grp                                                                               i_lesser    0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeии?иииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     update group                         SET__group                  BEG_UPDATE  + 3, BEG_CHECK   + 5                                                                      i_lesser    0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeии?иииии и   ии░иииииии и   ииииииииии и   иТ                                  

   COND       verify pushing forward when check was not run                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "file  Д testing conf file              Д a Д и Д и Д /tmp/themis.conf               Д root   Д ZAP    Д f_open     Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     locate the file                      CHECK__exist                BEG_CHECK   + 2, my.target                                                                            i_equal     0                                                                                                    
     exec     update group                         SET__group                  BEG_UPDATE  + 3, BEG_CHECK   + 5                                                                      i_lesser    0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeииииииии и   ии?иииииии и   ииииииииии и   иТ                                  

   COND       wrap up program                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.007))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     remove file                          yURG_rm                     x_name                                                                                                i_equal     0                                                                                                    
     exec     initialize the logger (quiet mode)   TEST__unit_end                                                                                                                    i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (SET) verify updating permissions                                  0s   perms           SET__perms                                                                   ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       initialize program                                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     initialize the logger (quiet mode)   TEST__unit_quiet                                                                                                                  i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char    x_recd   [LEN_RECD]  = "";                                                                                                                                                                                         
     local    create working variable              - - - - - - - - - - - - -   char    x_name   [LEN_PATH]  = "/tmp/themis.conf";                                                                                                                                                                         
     exec     remove file                          yURG_rm                     x_name                                                                                                i_equal     0                                                                                                    

   COND       verify updating an owner                                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     create test file                     yURG_touch                  x_name                                             , "member"  , "users"      , "0600"                i_equal     0                                                                                                    
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "file  Д testing conf file              Д a Д и Д и Д /tmp/themis.conf               Д root   Д root   Д f_open     Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     locate the file                      CHECK__exist                BEG_CHECK   + 2, my.target                                                                            i_equal     0                                                                                                    
     exec     check against root                   CHECK__perms                BEG_CHECK   + 6, my.perms                                                                             i_lesser    0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeиии-ииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     update group                         SET__perms                  BEG_UPDATE  + 4, BEG_CHECK   + 6                                                                      i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeиии-ииии и   иииPииииии и   ииииииииии и   иТ                                  

   COND       verify when owner is already correct                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "file  Д testing conf file              Д a Д и Д и Д /tmp/themis.conf               Д root   Д root   Д f_open     Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     locate the file                      CHECK__exist                BEG_CHECK   + 2, my.target                                                                            i_equal     0                                                                                                    
     exec     check against root                   CHECK__perms                BEG_CHECK   + 6, my.perms                                                                             i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeиииpииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     update group                         SET__perms                  BEG_UPDATE  + 4, BEG_CHECK   + 6                                                                      i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeиииpииии и   иииpииииии и   ииииииииии и   иТ                                  

   COND       verify pushing forward when check was bad                          - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "file  Д testing conf file              Д a Д и Д и Д /tmp/themis.conf               Д root   Д root   Д HEEHEE     Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     locate the file                      CHECK__exist                BEG_CHECK   + 2, my.target                                                                            i_equal     0                                                                                                    
     exec     check against root                   CHECK__perms                BEG_CHECK   + 6, my.perms                                                                             i_lesser    0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeиии?ииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     update group                         SET__perms                  BEG_UPDATE  + 4, BEG_CHECK   + 6                                                                      i_lesser    0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeиии?ииии и   иии░ииииии и   ииииииииии и   иТ                                  

   COND       verify pushing forward when check was not run                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "file  Д testing conf file              Д a Д и Д и Д /tmp/themis.conf               Д root   Д ZAP    Д f_open     Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     locate the file                      CHECK__exist                BEG_CHECK   + 2, my.target                                                                            i_equal     0                                                                                                    
     exec     update group                         SET__perms                  BEG_UPDATE  + 4, BEG_CHECK   + 6                                                                      i_lesser    0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тf a dtogp-- y   иeииииииии и   иии?ииииии и   ииииииииии и   иТ                                  

   COND       wrap up program                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.007))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     remove file                          yURG_rm                     x_name                                                                                                i_equal     0                                                                                                    
     exec     initialize the logger (quiet mode)   TEST__unit_end                                                                                                                    i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (SET) verify creating filesystem entries                           0s   exist           SET__exist                                                                   ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       initialize program                                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     initialize the logger (quiet mode)   TEST__unit_quiet                                                                                                                  i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char    x_recd   [LEN_RECD]  = "";                                                                                                                                                                                         
     local    create working variable              - - - - - - - - - - - - -   char    x_name   [LEN_PATH]  = "/tmp/themis";                                                                                                                                                                              

   COND       verify creating a directory                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     set entry name                       - - - - - - - - - - - - -   strlcpy (x_name, "/tmp/themis"                                     , LEN_PATH);                                                                                                                                                
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "dir   Д testing directory              Д a Д и Д и Д /tmp/themis                    Д root   Д root   Д d_open     Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     test the name                        CHECK__name                 BEG_CHECK   + 1, my.target                                                                            i_equal     0                                                                                                    
     exec     locate the file                      CHECK__exist                BEG_CHECK   + 2, my.target                                                                            i_lesser    0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   n-ииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     update exist                         SET__exist                  BEG_UPDATE  + 1, BEG_CHECK   + 2                                                                      i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   n-ииииииии и   Dиииииииии и   ииииииииии и   иТ                                  
     exec     remove file                          yURG_rmdir                  x_name                                                                                                i_equal     0                                                                                                    

   COND       verify creating a symlink                                          - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     set entry name                       - - - - - - - - - - - - -   strlcpy (x_name, "/tmp/fstabber"      , LEN_PATH);                                                                                                                                                
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "sym   Д testing symlink                Д a Д и Д и Д /tmp/fstabber                  Д ииииии Д ииииии Д ииииии     Д f Д /etc/fstab                     Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тs a dt---ts y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     test the name                        CHECK__name                 BEG_CHECK   + 1, my.target                                                                            i_equal     0                                                                                                    
     exec     locate the file                      CHECK__exist                BEG_CHECK   + 2, my.target                                                                            i_lesser    0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тs a dt---ts y   n-ииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     update exist                         SET__exist                  BEG_UPDATE  + 1, BEG_CHECK   + 2                                                                      i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тs a dt---ts y   n-ииииииии и   Sиииииииии и   ииииииииии и   иТ                                  
     exec     remove file                          yURG_rm                     x_name                                                                                                i_equal     0                                                                                                    

   COND       wrap up program                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.007))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     initialize the logger (quiet mode)   TEST__unit_end                                                                                                                    i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (SET) verify update driver                                         0s   driver          SET_driver                                                                   ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       initialize program                                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     initialize the logger (quiet mode)   TEST__unit_loud                                                                                                                   i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char    x_recd   [LEN_RECD]  = "";                                                                                                                                                                                         

   COND       verify creating a directory                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "dir   Д testing directory              Д a Д и Д и Д /tmp/themis                    Д root   Д root   Д d_tight    Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     check directory                      CHECK_dir                   1 , my.target                                      , my.own  , my.grp  , my.perms                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   n-----ииии а   ииииииииии и   ииииииииии и   иТ                                  
     exec     update directory                     SET_driver                                                                                                                        i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   n-----ииии а   DOGPииииии y   ииииииииии и   иТ                                  
     exec     check directory                      CHECK_dir                   2 , my.target                                      , my.own  , my.grp  , my.perms                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   n-----ииии а   DOGPииииии y   nedogpииии y   YТ                                  

   COND       verify checking on existing directory                              - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "dir   Д testing directory              Д a Д и Д и Д /tmp/themis                    Д root   Д root   Д d_tight    Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     check directory                      CHECK_dir                   1 , my.target                                      , my.own  , my.grp  , my.perms                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   nedogpииии y   ииииииииии и   ииииииииии и   иТ                                  
     exec     update directory                     SET_driver                                                                                                                        i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   nedogpииии y   ииииииииии y   ииииииииии и   иТ                                  
     exec     check directory                      CHECK_dir                   2 , my.target                                      , my.own  , my.grp  , my.perms                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   nedogpииии y   ииииииииии y   nedogpииии y   YТ                                  

   COND       verify changing the owner                                          - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "dir   Д testing directory              Д a Д и Д и Д /tmp/themis                    Д member Д root   Д d_tight    Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     check directory                      CHECK_dir                   1 , my.target                                      , my.own  , my.grp  , my.perms                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   ned-gpииии -   ииииииииии и   ииииииииии и   иТ                                  
     exec     update directory                     SET_driver                                                                                                                        i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   ned-gpииии -   eOgpииииии y   ииииииииии и   иТ                                  
     exec     check directory                      CHECK_dir                   2 , my.target                                      , my.own  , my.grp  , my.perms                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   ned-gpииии -   eOgpииииии y   nedogpииии y   YТ                                  

   COND       verify changing the group                                          - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "dir   Д testing directory              Д a Д и Д и Д /tmp/themis                    Д member Д users  Д d_tight    Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     check directory                      CHECK_dir                   1 , my.target                                      , my.own  , my.grp  , my.perms                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   nedo-pииии -   ииииииииии и   ииииииииии и   иТ                                  
     exec     update directory                     SET_driver                                                                                                                        i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   nedo-pииии -   eoGpииииии y   ииииииииии и   иТ                                  
     exec     check directory                      CHECK_dir                   2 , my.target                                      , my.own  , my.grp  , my.perms                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   nedo-pииии -   eoGpииииии y   nedogpииии y   YТ                                  

   COND       verify changing the premissions                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "dir   Д testing directory              Д a Д и Д и Д /tmp/themis                    Д member Д users  Д d_open     Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     check directory                      CHECK_dir                   1 , my.target                                      , my.own  , my.grp  , my.perms                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   nedog-ииии -   ииииииииии и   ииииииииии и   иТ                                  
     exec     update directory                     SET_driver                                                                                                                        i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   nedog-ииии -   eogPииииии y   ииииииииии и   иТ                                  
     exec     check directory                      CHECK_dir                   2 , my.target                                      , my.own  , my.grp  , my.perms                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd a dtogp-- y   nedog-ииии -   eogPииииии y   nedogpииии y   YТ                                  

   COND       verify removing directory                                          - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "dir   Д testing directory              Д x Д и Д и Д /tmp/themis                    Д - - -  Д - - -  Д - - -      Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd x dt----- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     check directory                      CHECK_dir                   1 , my.target                                      , my.own  , my.grp  , my.perms                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd x dt----- y   nedиииииии y   ииииииииии и   ииииииииии и   иТ                                  
     exec     update directory                     SET_driver                                                                                                                        i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd x dt----- y   nedиииииии y   xиииииииии y   ииииииииии и   иТ                                  
     exec     check directory                      CHECK_dir                   2 , my.target                                      , my.own  , my.grp  , my.perms                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd x dt----- y   nedиииииии y   xиииииииии y   n--иииииии а   YТ                                  

   COND       verify attempting to remove non-existant directory                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare record                       - - - - - - - - - - - - -   strlcpy (x_recd, "dir   Д testing directory              Д x Д и Д и Д /tmp/themis                    Д - - -  Д - - -  Д - - -      Д - Д - - - - - - - - - - - - - - -  Д", LEN_RECD);                                       
     exec     run parse                            CONF__parse                 BEG_PARSE, x_recd                                                                                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd x dt----- y   ииииииииии и   ииииииииии и   ииииииииии и   иТ                                  
     exec     check directory                      CHECK_dir                   1 , my.target                                      , my.own  , my.grp  , my.perms                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd x dt----- y   n--иииииии а   ииииииииии и   ииииииииии и   иТ                                  
     exec     update directory                     SET_driver                                                                                                                        i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd x dt----- y   n--иииииии а   ииииииииии y   ииииииииии и   иТ                                  
     exec     check directory                      CHECK_dir                   2 , my.target                                      , my.own  , my.grp  , my.perms                     i_equal     0                                                                                                    
     get      ... verify check                     CHECK__unit                 "check"       , 0                                                                                     s_equal     CHECK check      : тd x dt----- y   n--иииииии а   ииииииииии y   n--иииииии а   YТ                                  





   COND       wrap up program                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.007))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     initialize the logger (quiet mode)   TEST__unit_end                                                                                                                    i_equal     0                                                                                                    




